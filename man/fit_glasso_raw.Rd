% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_glasso.R
\name{fit_glasso_raw}
\alias{fit_glasso_raw}
\title{Fit graphical lasso on a raw count matrix (cells Ã— genes)}
\usage{
fit_glasso_raw(
  mat,
  min_genes = 200,
  max_genes = 2500,
  max_mt = 5,
  normalize = TRUE,
  sf = 10000,
  nfeatures = 20,
  rho = 0.1
)
}
\arguments{
\item{mat}{Numeric matrix with \strong{rows = cells} and \strong{columns = genes}.}

\item{min_genes}{Minimum genes per cell for QC (default 200).}

\item{max_genes}{Maximum genes per cell for QC (default 2500).}

\item{max_mt}{Maximum mitochondrial percent for QC (default 5).}

\item{normalize}{Logical; whether to perform library-size normalization
and log1p transform. Default TRUE.}

\item{sf}{Scale factor for normalization (default 10000).}

\item{nfeatures}{Number of variable features (genes) to use for glasso.}

\item{rho}{Regularization parameter for glasso.}
}
\value{
A list with:
\itemize{
\item \code{omega}: precision matrix (inverse covariance)
\item \code{sigma}: covariance matrix
\item \code{mu}: per-gene means
\item \code{sd}: per-gene standard deviations
\item \code{features}: selected genes
\item \code{glasso}: raw \code{glasso} fit object
\item \code{type}: "matrix"
}
}
\description{
This high-level wrapper (1) preprocesses a raw single-cell count matrix
(QC + optional normalization) and (2) runs graphical lasso on variable,
z-scored features. The interface mirrors \code{fit_glasso()} so that both
Seurat and raw-matrix workflows use identical parameters.
}
\examples{
\donttest{
if (requireNamespace("glasso", quietly = TRUE)) {
  m <- matrix(rpois(3000, 4), nrow = 100, ncol = 30,
              dimnames = list(paste0("C",1:100), paste0("G",1:30)))
  fit <- fit_glasso_raw(m,
 min_genes = 0,
 max_genes = 1e6,
 max_mt    = 100,  
 nfeatures = 5,
rho       = 0.05)
}
}

}
