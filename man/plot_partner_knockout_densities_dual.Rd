% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_network_effects.R
\name{plot_partner_knockout_densities_dual}
\alias{plot_partner_knockout_densities_dual}
\title{3D density plots from a glasso fit, ranked by mean and by variance (colored by magnitude)}
\usage{
plot_partner_knockout_densities_dual(
  fit,
  target,
  knocked = character(0),
  k = 15,
  use_original_units = TRUE,
  renormalize = TRUE,
  xlim = NULL,
  n = 200
)
}
\arguments{
\item{fit}{List from \code{auto_fit_glasso()}/\code{fit_glasso()} (needs \code{$sigma}, \code{$features};
for original units also needs \code{$sd}, and optionally \code{$mu}).}

\item{target}{Single gene (name or index) to predict.}

\item{knocked}{Vector of already-knocked genes (names or indices).}

\item{k}{Integer, how many partners to plot for each ranking (default 15).}

\item{use_original_units}{TRUE to recover covariance via sd (\eqn{\Sigma = D R D}). If FALSE, use corr scale.}

\item{renormalize}{TRUE to \code{cov2cor(fit$sigma)} before scaling when recovering \eqn{\Sigma}.}

\item{xlim}{Optional length-2 numeric x-range for the pdf curves; NULL = auto.}

\item{n}{Number of x points per curve (default 200).}
}
\value{
list(mean_plot = plotly_object, var_plot = plotly_object)
}
\description{
Produces two interactive 3D line plots (via plotly): top-K partners ranked by
\code{|conditional mean|} and top-K partners ranked by \code{conditional variance}.
Colors encode the magnitude used for ranking (|mean| or variance respectively).
}
\examples{
\donttest{
if (requireNamespace("plotly", quietly = TRUE)) {
  # Tiny synthetic "fit" object on 6 genes to keep examples fast:
  set.seed(2)
  genes <- paste0("G", 1:6)
  R     <- diag(6)
  R[1,2] <- R[2,1] <- 0.4
  R[1,3] <- R[3,1] <- -0.3
  sdv   <- runif(6, 0.8, 1.2)
  Sigma <- diag(sdv) \%*\% R \%*\% diag(sdv)
  fit   <- list(
    sigma    = stats::cov2cor(Sigma),  # pretend we estimated corr
    sd       = sdv,
    mu       = rep(0, 6),
    features = genes
  )
  plt <- plot_partner_knockout_densities_dual(
    fit, target = "G1", knocked = "G2", k = 3,
    use_original_units = TRUE
  )
  # In interactive R, print to view:
  # plt$mean_plot; plt$var_plot
}
}

}
\references{
C. Sievert (2020). \emph{Interactive Web-Based Data Visualization with R, plotly, and shiny}.
Chapman & Hall/CRC.
Anderson, T.W. (2003). \emph{An Introduction to Multivariate Statistical Analysis} (3rd ed.).
Wiley.
}
\seealso{
\code{\link{recover_covariance}}, \code{\link{predict_conditional_knockout}},
\code{\link{auto_fit_glasso}}, \code{\link{fit_glasso}}
}
