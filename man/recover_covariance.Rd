% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_comb.R
\name{recover_covariance}
\alias{recover_covariance}
\title{Recover covariance in original units from a glasso fit on correlation scale}
\usage{
recover_covariance(fit, renormalize = TRUE)
}
\arguments{
\item{fit}{A list with components \code{sigma}, \code{sd}, and \code{features}
as returned by \code{run_glasso_seurat()}.}

\item{renormalize}{Logical; if TRUE (default), first convert \code{fit$sigma}
to an exact correlation matrix with \code{stats::cov2cor()} before scaling.}
}
\value{
A covariance matrix in original units (dimnames set to \code{features}).
}
\description{
Given the output list from \code{run_glasso_seurat()} (which contains
\code{sigma} estimated on the correlation scale and per-gene \code{sd}),
reconstruct the covariance matrix in the original units via
\eqn{\Sigma = D \, R \, D}, where \eqn{D = \mathrm{diag}(\text{sd})}
and \eqn{R = \mathrm{cov2cor}(\text{sigma})}.
}
\keyword{internal}
