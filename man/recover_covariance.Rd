% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_comb.R
\name{recover_covariance}
\alias{recover_covariance}
\title{Recover covariance in original units from a glasso fit on correlation scale}
\usage{
recover_covariance(fit, renormalize = TRUE)
}
\arguments{
\item{fit}{A list with components \code{sigma}, \code{sd}, and \code{features}
as returned by \code{run_glasso_seurat()}.}

\item{renormalize}{Logical; if TRUE (default), first convert \code{fit$sigma}
to an exact correlation matrix with \code{stats::cov2cor()} before scaling.}
}
\value{
A covariance matrix in original units (dimnames set to \code{features}).
}
\description{
Given the output list from \code{run_glasso_seurat()} (which contains
\code{sigma} estimated on the correlation scale and per-gene \code{sd}),
reconstruct the covariance matrix in the original units via
\eqn{\Sigma = D \, R \, D}, where \eqn{D = \mathrm{diag}(\text{sd})}
and \eqn{R = \mathrm{cov2cor}(\text{sigma})}.
}
\examples{
# Suppose a fit list stores correlation (sigma) and per-gene sds:
set.seed(1)
genes <- paste0("G", 1:5)
R <- diag(5); R[1,2] <- R[2,1] <- 0.5
sdv <- runif(5, 0.7, 1.3)
fit_demo <- list(sigma = R, sd = sdv, features = genes)
S_cov <- recover_covariance(fit_demo, renormalize = TRUE)
dimnames(S_cov)

}
\references{
Anderson, T.W. (2003) \emph{An Introduction to Multivariate Statistical Analysis} (3rd ed.). Wiley.
}
\seealso{
\code{\link{predict_knockout_from_fit}}, \code{\link{run_glasso_seurat}}
}
\keyword{internal}
