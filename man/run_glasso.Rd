% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_glasso.R
\name{run_glasso}
\alias{run_glasso}
\title{Run Graphical Lasso on a Seurat Object or Raw Count Matrix}
\usage{
run_glasso(x, nfeatures = 2000, rho = 0.1, ...)
}
\arguments{
\item{x}{A Seurat object (already normalized) or a numeric matrix
with \strong{rows = cells} and \strong{columns = genes}.}

\item{nfeatures}{Integer. Number of highly variable genes to select.
Default: 2000.}

\item{rho}{Numeric. L1-regularization parameter passed to
\code{glasso::glasso()}. Default: 0.1.}

\item{...}{Additional arguments passed to \code{preprocess_matrix_raw()}
when the input is a raw matrix (e.g., QC thresholds).}
}
\value{
A list with components:
\itemize{
\item \code{omega} — estimated precision matrix (inverse covariance)
\item \code{sigma} — estimated covariance matrix
\item \code{mu} — per-gene means (of normalized values)
\item \code{sd} — per-gene standard deviations
\item \code{features} — vector of gene names used
\item \code{glasso} — raw \code{glasso} fit object
\item \code{type} — either \code{"seurat"} or \code{"matrix"}
}
}
\description{
This unified wrapper automatically detects whether the input is a
\code{Seurat} object or a raw count matrix with rows representing cells
and columns representing genes. It applies the appropriate preprocessing
pipeline (QC + normalization for raw matrices, variable feature
selection + z-scoring for Seurat) before estimating a sparse precision
matrix using the graphical lasso.
}
\details{
\strong{If the input is a Seurat object}
The function:
\enumerate{
\item selects variable features via \code{Seurat::FindVariableFeatures()},
\item extracts normalized data (layer/slot = "data"),
\item computes per-gene mean and standard deviation,
\item z-scores genes,
\item computes covariance across selected genes,
\item runs \code{glasso::glasso()}.
}

\strong{If the input is a raw matrix}
The function:
\enumerate{
\item performs QC (min/max genes, mitochondrial\%, etc.),
\item normalizes by library size and applies log1p,
\item selects variable genes by variance,
\item z-scores genes,
\item computes covariance,
\item runs \code{glasso::glasso()}.
}
}
\examples{
\donttest{
if (requireNamespace("Seurat", quietly = TRUE) &&
    requireNamespace("glasso", quietly = TRUE)) {
  set.seed(1)
  m <- matrix(rpois(3000, 5), nrow = 100, ncol = 30,
              dimnames = list(paste0("G",1:100), paste0("C",1:30)))
  obj <- Seurat::CreateSeuratObject(m)
  obj <- Seurat::NormalizeData(obj)

  fit1 <- run_glasso(obj, nfeatures = 200, rho = 0.2)
  fit2 <- run_glasso(m,   nfeatures = 200, rho = 0.2)
}
}

}
\references{
Friedman, J., Hastie, T., & Tibshirani, R. (2008).
Sparse inverse covariance estimation with the graphical lasso.
\emph{Biostatistics} 9(3), 432–441.

Hao, Y. et al. (2021). Integrated analysis of multimodal single-cell data.
\emph{Cell} 184(13):3573–3587.
}
