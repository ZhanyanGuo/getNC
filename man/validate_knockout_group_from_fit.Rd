% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/validate_predictions.R
\name{validate_knockout_group_from_fit}
\alias{validate_knockout_group_from_fit}
\title{Group tests for a knockout using a glasso-style fit (1D target)}
\usage{
validate_knockout_group_from_fit(
  fit,
  target,
  knocked,
  y,
  use_original_units = TRUE,
  renormalize = TRUE
)
}
\arguments{
\item{fit}{List from auto_fit_glasso()/fit_glasso() (needs $sigma, $features;
for original units also needs $sd and optionally $mu).}

\item{target}{Single gene (name or index) whose expression was measured.}

\item{knocked}{Character or integer vector of genes set to 0 in the experiment.}

\item{y}{Numeric vector of observed target expression under this knockout set.}

\item{use_original_units}{Logical; if TRUE (default) recover covariance in original units;
if FALSE, operate on correlation scale.}

\item{renormalize}{Logical; passed to recover_covariance() when use_original_units=TRUE.}
}
\value{
A list with:
\describe{
\item{target}{target gene name}
\item{knocked}{character vector of knocked genes}
\item{mean_cond}{scalar conditional mean from the model}
\item{var_cond}{scalar conditional variance from the model}
\item{p_mean}{two-sided t test p-value on mean}
\item{p_chisq}{two-sided Chi-square test p-value on sum of squares}
\item{n}{number of observations}
}
}
\description{
For a single target gene and a set of knocked genes, compute the model's
conditional Normal N(mu_cond, var_cond) from \code{fit}, then evaluate a vector
of observations \code{y} with two omnibus p-values:
\itemize{
\item p_mean  : two-sided t test on the sample mean (using the sample sd)
\item p_chisq : two-sided chi-square test on sum((y - mu_cond)^2 / var_cond)
}
}
\examples{
\dontrun{
  suppressPackageStartupMessages(library(getNC))

  # 1) Fit a model using the packaged example data
  fit <- fit_glasso(obj = NULL, nfeatures = 100, rho = 0.2)

  genes   <- fit$features
  target  <- genes[5]
  knocked <- genes[c(3, 7, 9)]

  # 2) Pull the conditional distribution for target | knocked=0
  cond <- predict_knockout_from_fit(
    fit, target = target, knocked = knocked, use_original_units = TRUE
  )
  mu_c  <- as.numeric(cond$mean_cond[1])
  var_c <- as.numeric(cond$cov_cond[1, 1])

  # 3) Simulate replicate measurements under that model
  # in practice, use knockout experiment 1D RNA counting vector
  set.seed(42)
  y_obs <- rnorm(40, mean = mu_c, sd = sqrt(max(var_c, 0)))

  # 4) Validate (t-mean + chi-square)
  res <- validate_knockout_group_from_fit(
    fit, target = target, knocked = knocked, y = y_obs, use_original_units = TRUE
  )
  str(res)
  cat(sprintf("p_mean = \%.3g, p_chisq = \%.3g\n", res$p_mean, res$p_chisq))
}

}
\references{
Friedman, J., Hastie, T., & Tibshirani, R. (2008).
Sparse inverse covariance estimation with the graphical lasso.
\emph{Biostatistics}, 9(3), 432–441. \doi{10.1093/biostatistics/kxm045}

Hao, Y., Hao, S., Andersen-Nissen, E., et al. (2021).
Integrated analysis of multimodal single-cell data.
\emph{Cell}, 184(13), 3573–3587. \doi{10.1016/j.cell.2021.04.048}

Bishop, C. M. (2006). \emph{Pattern Recognition and Machine Learning}.
Springer. (Multivariate Normal conditioning identities)

Murphy, K. P. (2012). \emph{Machine Learning: A Probabilistic Perspective}.
MIT Press. (Conditioning and marginalization in Gaussians)

Student (1908). "The probable error of a mean." \emph{Biometrika}, 6(1), 1–25.

Fisher, R.A. (1924). "On a distribution yielding the error functions of
several well known statistics." \emph{Proceedings of the ICM}, 2, 805–813.
}
\seealso{
\code{\link{fit_glasso}}, \code{\link{auto_fit_glasso}},
\code{\link{predict_knockout_from_fit}}, \code{\link{recover_covariance}}
}
