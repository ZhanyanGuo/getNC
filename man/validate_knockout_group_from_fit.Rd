% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/validate_predictions.R
\name{validate_knockout_group_from_fit}
\alias{validate_knockout_group_from_fit}
\title{Group tests for a knockout using a glasso-style fit (1D target)}
\usage{
validate_knockout_group_from_fit(
  fit,
  target,
  knocked,
  y,
  use_original_units = TRUE,
  renormalize = TRUE
)
}
\arguments{
\item{fit}{List from run_glasso_seurat()/fit_glasso() (needs $sigma, $features;
for original units also needs $sd and optionally $mu).}

\item{target}{Single gene (name or index) whose expression was measured.}

\item{knocked}{Character or integer vector of genes set to 0 in the experiment.}

\item{y}{Numeric vector of observed target expression under this knockout set.}

\item{use_original_units}{Logical; if TRUE (default) recover covariance in original units;
if FALSE, operate on correlation scale.}

\item{renormalize}{Logical; passed to recover_covariance() when use_original_units=TRUE.}
}
\value{
A list with:
\describe{
\item{target}{target gene name}
\item{knocked}{character vector of knocked genes}
\item{mean_cond}{scalar conditional mean from the model}
\item{var_cond}{scalar conditional variance from the model}
\item{p_mean}{two-sided t test p-value on mean(z)}
\item{p_chisq}{two-sided Chi-square test p-value on sum(z^2)}
\item{n}{number of observations}
}
}
\description{
For a single target gene and a set of knocked genes, compute the model's
conditional Normal N(mu_cond, var_cond) from \code{fit}, then evaluate a vector
of observations \code{y} with two omnibus p-values:
\itemize{
\item p_mean  : t test on mean(z), two-sided
\item p_chisq : Chi-square test on sum(z^2), two-sided
}
}
